var t=t=>{let e="";const i=["i","I","m","M","a","A","g","G","e","E","b","B","o","O","x","X"];for(let s=0;s<t;s++){e+=i[Math.floor(Math.random()*i.length)]}return e},e=(t,e)=>{if(!t)throw new Error("Element doens't exist");Object.keys(e).forEach((i=>{t.style[i]=e[i]}))},i=(t,e="flex")=>{t.forEach((t=>{t.style.display=e}))};class s{constructor(){this._toast=null,this._toastTextHeading=null,this._toastTimeBar=null,this._defaultStyle={},this._highPriorityQueue=[],this._normalPriorityQueue=[],this._lowPriorityQueue=[],this._areQueuesBeingDispatched=!1,this.__init__()}get domTools(){return this._domTools}get toast(){return this._toast}get toastTimeBar(){return this._toastTimeBar}get toastTextHeading(){return this._toastTextHeading}get highPriorityQueue(){return this._highPriorityQueue}get normalPriorityQueue(){return this._normalPriorityQueue}get lowPriorityQueue(){return this._lowPriorityQueue}get areQueuesBeingDispatched(){return this._areQueuesBeingDispatched}set toast(t){this._toast=t}set toastTimeBar(t){this._toastTimeBar=t}set toastTextHeading(t){this._toastTextHeading=t}set areQueuesBeingDispatched(t){this._areQueuesBeingDispatched=t}_generateToastClass(){return t(10)+"_toast"}_generateToastTimeBarClass(){return t(10)+"_toast_timebar"}_getFirstItemInQueue(t){switch(t){case"high":return this.highPriorityQueue[this.highPriorityQueue.length-1];case"normal":return this.normalPriorityQueue[this.normalPriorityQueue.length-1];case"low":return this.lowPriorityQueue[this.lowPriorityQueue.length-1]}}_removeFirstItemInQueue(t){switch(t){case"high":this._highPriorityQueue.shift();break;case"normal":this._normalPriorityQueue.shift();break;case"low":this._lowPriorityQueue.shift()}}async _displayOneMessageByPriority(e){return new Promise(((i,s)=>{this.areQueuesBeingDispatched=!0;const{message:n,duration:a}=this._getFirstItemInQueue(e);n||s(null),this.toast.style.display="initial",this.toastTextHeading.textContent=n;const r=t(10)+"_style",o=t(10)+"_toast_anim",h=t(10)+"_toast_anim_keyframes",l=`\n        <style type="text/css" id="${r}">\n          .${o} {\n            animation: ${h} ${a}ms;\n          }\n\n          @keyframes ${h} {\n            to {\n              width: 0%;\n            }\n          }\n        </style>\n      `;document.querySelector("body").insertAdjacentHTML("afterbegin",l),this.toastTimeBar.style.display="initial",this.toastTimeBar.classList.add(o),setTimeout((()=>{this.toast.style.display="none",this.toastTextHeading.textContent="",this.toastTimeBar.style.display="none";document.querySelector(`style#${r}`).remove(),this._removeFirstItemInQueue(e),i(!0)}),a)}))}async _displayAllMessages(){const t=0!==this.highPriorityQueue.length,e=0!==this.normalPriorityQueue.length,i=0!==this.lowPriorityQueue.length;if(t||e||i){if(t){if(await this._displayOneMessageByPriority("high"))return this._displayAllMessages();throw new Error("Error trying to display high priority message")}if(e){if(await this._displayOneMessageByPriority("normal"))return this._displayAllMessages();throw new Error("Error trying to display normal priority message")}if(i){if(await this._displayOneMessageByPriority("low"))return this._displayAllMessages();throw new Error("Error trying to display low priority message")}}else this.areQueuesBeingDispatched=!1}putMessage(t,e,i){const s={message:t,duration:e};switch(i){case"high":this._highPriorityQueue.unshift(s);break;case"normal":this._normalPriorityQueue.unshift(s);break;case"low":this._lowPriorityQueue.unshift(s)}this.areQueuesBeingDispatched||this._displayAllMessages()}_setToastTimeBarStyle(t){Object.keys(t).forEach((e=>{this.toastTimeBar.style[e]=t[e]}))}setStyle(t){Object.keys(t).forEach((e=>{"toastTimeBar"===e?this._setToastTimeBarStyle(t[e]):this.toast.style[e]=t[e]}))}__init__(){const t=document.querySelector("body"),e=this._generateToastClass(),i=this._generateToastTimeBarClass();t.insertAdjacentHTML("beforeend",`\n      <div style="\n        pointer-events: none;\n        width: 100vw;\n        height: 100vh;\n        position: fixed;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n      ">\n        <span class="${e}">\n          <p></p>\n          <span class="${i}"></span>\n        </span>\n      </div>\n    `),this.toast=document.querySelector(`.${e}`),this.toastTimeBar=document.querySelector(`.${i}`),this.toastTextHeading=document.querySelector(`.${e} > p`),this.setStyle({overflow:"hidden",pointerEvents:"none",display:"none",color:"#ffffff",position:"relative",transform:"translateY(calc(50vh - 250%))",width:"max-content",height:"max-content",padding:"1rem 2rem",background:"#2B2A33",borderRadius:"5px",toastTimeBar:{display:"none",width:"100%",pointerEvents:"none",height:"2.5px",background:"#fff",position:"absolute",left:0,bottom:0}})}}var n=(t,e=!1)=>!1===e?document.querySelector(t):document.querySelectorAll(t),a=t=>`${t}px`,r=t=>new Date(t).toLocaleTimeString("en-EN"),o=t=>t.length-1,h=t=>{const e=t.toLowerCase();return e.charAt(0).toUpperCase()+e.slice(1)},l='\n    <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <path d="M5.53431e-08 11.0031C-0.000210465 10.2622 0.600212 9.66148 1.34108 9.66127C2.08195 9.66106 2.68272 10.2615 2.68293 11.0024C2.6835 13.0195 3.41712 14.9677 4.74719 16.4842C6.07727 18.0006 7.91313 18.9821 9.91296 19.2457C11.9128 19.5093 13.9403 19.0372 15.6179 17.9172C17.2956 16.7973 18.509 15.1057 19.0323 13.1577C19.5556 11.2096 19.3531 9.13775 18.4625 7.32787C17.5719 5.51799 16.0539 4.09345 14.1912 3.3195C12.3284 2.54555 10.2479 2.47493 8.33696 3.12079C7.24931 3.4884 6.2588 4.07385 5.42074 4.83188H7.37778C8.11865 4.83188 8.71925 5.43248 8.71925 6.17334C8.71925 6.91421 8.11865 7.51481 7.37778 7.51481H2.54852C1.80765 7.51481 1.20705 6.91421 1.20705 6.17334V1.34408C1.20705 0.603213 1.80765 0.00262004 2.54852 0.00262004C3.28939 0.00262004 3.88998 0.603213 3.88998 1.34408V2.60669C4.93916 1.71793 6.15414 1.02653 7.47791 0.579112C10.0053 -0.275095 12.757 -0.181695 15.2206 0.841922C17.6842 1.86554 19.6919 3.74961 20.8698 6.14332C22.0477 8.53703 22.3155 11.2772 21.6234 13.8537C20.9313 16.4302 19.3264 18.6673 17.1076 20.1486C14.8888 21.6299 12.2072 22.2543 9.56231 21.9056C6.91737 21.5569 4.48929 20.2589 2.73016 18.2532C0.971033 16.2476 0.000758619 13.6709 5.53431e-08 11.0031Z"/>\n    </svg>\n  ',c='\n    <svg width="16" height="14" viewBox="0 0 16 14" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <path d="M7.7107 9.83444C7.6057 9.79178 7.50991 9.7289 7.42958 9.65014L4.4978 6.77944C4.41736 6.70068 4.35356 6.60718 4.31003 6.50427C4.26649 6.40136 4.24409 6.29107 4.24409 6.17969C4.24409 6.06831 4.26649 5.95801 4.31003 5.85511C4.35356 5.7522 4.41736 5.6587 4.4978 5.57994C4.57824 5.50118 4.67373 5.4387 4.77882 5.39608C4.88392 5.35345 4.99656 5.33151 5.11031 5.33151C5.22406 5.33151 5.3367 5.35345 5.4418 5.39608C5.54689 5.4387 5.64244 5.50124 5.72288 5.58L7.16071 6.98841L7.1768 6.97266V2.07812C7.1768 1.52697 7.4004 0.998393 7.79842 0.608669C8.19643 0.218945 8.73626 0 9.29914 0H13.0691C13.632 0 14.1718 0.218945 14.5698 0.608669C14.9678 0.998393 15.1914 1.52697 15.1914 2.07812V11.9219C15.1914 12.473 14.9678 13.0016 14.5698 13.3913C14.1718 13.7811 13.632 14 13.0691 14H3.0159C2.45302 14 1.91319 13.7811 1.51517 13.3913C1.11716 13.0016 0.893555 12.473 0.893555 11.9219V2.07812C0.893555 1.52697 1.11716 0.998393 1.51517 0.608669C1.91319 0.218945 2.45302 0 3.0159 0H5.11031C5.33991 0 5.5601 0.0893064 5.72245 0.248273C5.8848 0.407239 5.976 0.622844 5.976 0.847656C5.976 1.07247 5.8848 1.28807 5.72245 1.44704C5.5601 1.60601 5.33991 1.69531 5.11031 1.69531H3.0159C2.91221 1.69531 2.81277 1.73564 2.73945 1.80744C2.66613 1.87923 2.62494 1.9766 2.62494 2.07812V11.9219C2.62494 12.0234 2.66613 12.1208 2.73945 12.1926C2.81277 12.2644 2.91221 12.3047 3.0159 12.3047H13.0691C13.1728 12.3047 13.2722 12.2644 13.3455 12.1926C13.4189 12.1208 13.46 12.0234 13.46 11.9219V2.07812C13.46 1.9766 13.4189 1.87923 13.3455 1.80744C13.2722 1.73564 13.1728 1.69531 13.0691 1.69531H9.29914C9.19545 1.69531 9.09601 1.73564 9.02269 1.80744C8.94937 1.87923 8.90818 1.9766 8.90818 2.07812V7.00416L10.3621 5.58C10.5245 5.42093 10.7449 5.33151 10.9747 5.33151C11.2044 5.33151 11.4247 5.42087 11.5872 5.57994C11.7496 5.739 11.8409 5.95474 11.8409 6.17969C11.8409 6.40464 11.7496 6.62037 11.5872 6.77944L8.6554 9.65014C8.57507 9.7289 8.47928 9.79178 8.37428 9.83444C8.26911 9.87717 8.15636 9.89917 8.04249 9.89917C7.92862 9.89917 7.81587 9.87717 7.7107 9.83444Z" fill="white"/>\n    </svg>\n  ',u='\n    <svg width="16" height="14" viewBox="0 0 16 14" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <path d="M7.7107 4.16556C7.6057 4.20822 7.50991 4.2711 7.42958 4.34986L4.4978 7.22056C4.41736 7.29932 4.35356 7.39282 4.31003 7.49573C4.26649 7.59864 4.24409 7.70893 4.24409 7.82031C4.24409 7.93169 4.26649 8.04199 4.31003 8.14489C4.35356 8.2478 4.41736 8.3413 4.4978 8.42006C4.57824 8.49882 4.67373 8.5613 4.77882 8.60392C4.88392 8.64655 4.99656 8.66849 5.11031 8.66849C5.22406 8.66849 5.3367 8.64655 5.4418 8.60392C5.54689 8.5613 5.64244 8.49876 5.72288 8.42L7.16071 7.01159L7.1768 7.02734V11.9219C7.1768 12.473 7.4004 13.0016 7.79842 13.3913C8.19643 13.7811 8.73626 14 9.29914 14H13.0691C13.632 14 14.1718 13.7811 14.5698 13.3913C14.9678 13.0016 15.1914 12.473 15.1914 11.9219V2.07812C15.1914 1.52697 14.9678 0.998392 14.5698 0.608668C14.1718 0.218945 13.632 0 13.0691 0H3.0159C2.45302 0 1.91319 0.218945 1.51517 0.608668C1.11716 0.998392 0.893555 1.52697 0.893555 2.07812V11.9219C0.893555 12.473 1.11716 13.0016 1.51517 13.3913C1.91319 13.7811 2.45302 14 3.0159 14H5.11031C5.33991 14 5.5601 13.9107 5.72245 13.7517C5.8848 13.5928 5.976 13.3772 5.976 13.1523C5.976 12.9275 5.8848 12.7119 5.72245 12.553C5.5601 12.394 5.33991 12.3047 5.11031 12.3047H3.0159C2.91221 12.3047 2.81277 12.2644 2.73945 12.1926C2.66613 12.1208 2.62494 12.0234 2.62494 11.9219V2.07812C2.62494 1.9766 2.66613 1.87923 2.73945 1.80744C2.81277 1.73564 2.91221 1.69531 3.0159 1.69531H13.0691C13.1728 1.69531 13.2722 1.73564 13.3455 1.80744C13.4189 1.87923 13.46 1.9766 13.46 2.07812V11.9219C13.46 12.0234 13.4189 12.1208 13.3455 12.1926C13.2722 12.2644 13.1728 12.3047 13.0691 12.3047H9.29914C9.19545 12.3047 9.09601 12.2644 9.02269 12.1926C8.94937 12.1208 8.90818 12.0234 8.90818 11.9219V6.99584L10.3621 8.42C10.5245 8.57907 10.7449 8.66849 10.9747 8.66849C11.2044 8.66849 11.4247 8.57913 11.5872 8.42006C11.7496 8.261 11.8409 8.04526 11.8409 7.82031C11.8409 7.59536 11.7496 7.37963 11.5872 7.22056L8.6554 4.34986C8.57507 4.2711 8.47928 4.20822 8.37428 4.16556C8.26911 4.12283 8.15636 4.10083 8.04249 4.10083C7.92862 4.10083 7.81587 4.12283 7.7107 4.16556Z" fill="white"/>\n    </svg>\n  ',d='\n    <svg width="16" height="4" viewBox="0 0 16 4" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <path d="M3.92748 2C3.92748 0.909091 3.03487 0 1.96374 0C0.870293 0 0 0.909091 0 2C0 3.09091 0.870293 4 1.96374 4C3.03487 4 3.92748 3.09091 3.92748 2ZM9.95258 2C9.95258 0.909091 9.05997 0 7.98884 0C6.91771 0 6.0251 0.909091 6.0251 2C6.0251 3.09091 6.91771 4 7.98884 4C9.05997 4 9.95258 3.09091 9.95258 2ZM16 2C16 0.909091 15.1297 0 14.0363 0C12.9651 0 12.0725 0.909091 12.0725 2C12.0725 3.09091 12.9651 4 14.0363 4C15.1297 4 16 3.09091 16 2Z" fill="#454545"/>\n    </svg>\n  ',g='\n    <svg width="15" height="13" viewBox="0 0 15 13" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <path d="M15 2.14286H12.8036C12.5357 0.910714 11.4643 0 10.1786 0C8.89286 0 7.82143 0.910714 7.55357 2.14286H0V3.21429H7.55357C7.82143 4.44643 8.89286 5.35714 10.1786 5.35714C11.4643 5.35714 12.5357 4.44643 12.8036 3.21429H15V2.14286ZM10.1786 4.28571C9.26786 4.28571 8.57143 3.58929 8.57143 2.67857C8.57143 1.76786 9.26786 1.07143 10.1786 1.07143C11.0893 1.07143 11.7857 1.76786 11.7857 2.67857C11.7857 3.58929 11.0893 4.28571 10.1786 4.28571Z" fill="#454545"/>\n      <path d="M0 10.7143H2.19643C2.46429 11.9464 3.53571 12.8571 4.82143 12.8571C6.10714 12.8571 7.17857 11.9464 7.44643 10.7143H15V9.64286H7.44643C7.17857 8.41071 6.10714 7.5 4.82143 7.5C3.53571 7.5 2.46429 8.41071 2.19643 9.64286H0V10.7143ZM4.82143 8.57143C5.73214 8.57143 6.42857 9.26786 6.42857 10.1786C6.42857 11.0893 5.73214 11.7857 4.82143 11.7857C3.91071 11.7857 3.21429 11.0893 3.21429 10.1786C3.21429 9.26786 3.91071 8.57143 4.82143 8.57143Z" fill="#454545"/>\n    </svg>\n  ',_='\n    <svg width="218" height="136" viewBox="0 0 218 136" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <rect width="217.721" height="135.562" rx="3" fill="#EDEDED"/>\n      <rect x="183" y="125" width="32" height="8" rx="1" fill="#80CDB4"/>\n      <rect x="149" y="125" width="32" height="8" rx="1" fill="#DFDFDF"/>\n      <rect x="3" y="124.608" width="8.21591" height="8.21591" rx="1" fill="#DFDFDF"/>\n      <rect x="12.5854" y="124.608" width="8.21591" height="8.21591" rx="1" fill="#DFDFDF"/>\n      <rect x="41" y="5" width="136" height="118" rx="3" fill="url(#paint0_linear-446667)" fill-opacity="0.2"/>\n      <rect x="183" y="19" width="32" height="96" rx="2" fill="#DFDFDF"/>\n      <rect x="3" y="19" width="32" height="96" rx="2" fill="#DFDFDF"/>\n      <rect x="183" y="5" width="32" height="8" rx="2" fill="#DFDFDF"/>\n      <rect x="3" y="5" width="32" height="8" rx="2" fill="#DFDFDF"/>\n      <path d="M0 3C0 1.34315 1.34315 0 3 0H87L43.5 27L0 54V3Z" fill="white" fill-opacity="0.3"/>\n      <path d="M218 132C218 133.657 216.657 135 215 135H81L149.5 92.5L218 50V132Z" fill="white" fill-opacity="0.3"/>\n      <defs>\n        <linearGradient id="paint0_linear-446667" x1="109" y1="5" x2="109" y2="123" gradientUnits="userSpaceOnUse">\n          <stop offset="0.5" stop-color="#B9B9B9"/>\n          <stop offset="1" stop-color="#F2F2F2" stop-opacity="0"/>\n        </linearGradient>\n      </defs>\n    </svg>\n  ',p='\n    <svg width="218" height="136" viewBox="0 0 218 136" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <rect width="218" height="136" rx="3" fill="#212128"/>\n      <rect x="183" y="125" width="32" height="8" rx="1" fill="#18A0FB"/>\n      <rect x="149" y="125" width="32" height="8" rx="1" fill="#1A1A20"/>\n      <rect x="3" y="124.608" width="8.21591" height="8.21591" rx="1" fill="#1A1A20"/>\n      <rect x="12.5854" y="124.608" width="8.21591" height="8.21591" rx="1" fill="#1A1A20"/>\n      <rect x="41" y="5" width="136" height="118" rx="3" fill="url(#paint0_linear-310517)" fill-opacity="0.2"/>\n      <rect x="183" y="19" width="32" height="96" rx="2" fill="#1A1A20"/>\n      <rect x="3" y="19" width="32" height="96" rx="2" fill="#1A1A20"/>\n      <rect x="183" y="5" width="32" height="8" rx="2" fill="#1A1A20"/>\n      <rect x="3" y="5" width="32" height="8" rx="2" fill="#1A1A20"/>\n      <path d="M0 3C0 1.34315 1.34315 0 3 0H87L43.5 27L0 54V3Z" fill="black" fill-opacity="0.16"/>\n      <path d="M218 133C218 134.657 216.657 136 215 136H131L174.5 109L218 82V133Z" fill="black" fill-opacity="0.16"/>\n      <path d="M217.829 16L36 135.5H3.00002C1.34315 135.5 1.52588e-05 134.157 1.52588e-05 132.5V111L168.25 0.492493C168.739 0.171204 169.312 0 169.897 0H214.829C216.486 0 217.829 1.34314 217.829 3V16Z" fill="black" fill-opacity="0.16"/>\n      <defs>\n        <linearGradient id="paint0_linear-310517" x1="109" y1="5" x2="109" y2="123" gradientUnits="userSpaceOnUse">\n          <stop offset="0.411458"/>\n          <stop offset="1" stop-color="#1C1B22" stop-opacity="0"/>\n        </linearGradient>\n      </defs>\n    </svg>\n  ',m='\n    <svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <path d="M16 1L1 16M16 16L1 1L16 16Z" stroke="#454545" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n    </svg>\n  ',y={light:{"--main-background":"#F9F9F9","--main-accent":"#0EC788","--header-text-primary":"#454545","--header-text-secondary":"#868686","--toolbar-button-background-primary":"#E3E3E3","--toolbar-button-text-primary":"#454545","--toolbar-button-background-primary-hover":"#BEBEBE","--toolbar-button-text-primary-hover":"#ffffff","--toolbar-button-background-important":"var(--main-accent)","--toolbar-button-text-important":"#ffffff","--toolbar-button-background-important-hover":"#33B58A","--toolbar-button-text-important-hover":"#ffffff","--selection-button-background-primary":"#ffffff","--selection-button-text-primary":"#454545","--selection-button-background-important":"var(--main-accent)","--selection-button-text-important":"#ffffff","--history-header-text":"#454545","--history-header-button-background":"#D3F1E7","--history-header-button-border":"#C3EEE0","--history-header-button-text":"var(--main-accent)","--history-header-button-background-disabled":"#F1F1F1","--history-header-button-border-disabled":"#F3F3F3","--history-header-button-text-disabled":"#EBEBEB","--history-button-background-hover":"#EFEFEF","--history-button-action-text":"var(--main-accent)","--history-button-timestamp-text":"#6D6D6D","--history-button-icon-color":"#BABABA","--history-button-active-background":"var(--main-accent)","--history-button-active-text":"#FFFFFF","--effects-header-text":"#454545","--effects-header-button-background":"#D3F1E7","--effects-header-button-border":"#C3EEE0","--effects-header-button-text":"var(--main-accent)","--filter-wrapper-background-hover":"#EFEFEF","--filter-header-text-primary":"#454545","--filter-button-reset-color":"#454545","--filter-header-info-current-background":"#D3F1E7","--filter-header-info-current-border":"#C3EEE0","--filter-header-info-current-text":"var(--main-accent)","--filter-input-track":"#E0E0E0","--filter-input-thumb":"var(--main-accent)","--filter-input-track-filled":"var(--main-accent)","--settings-panel-borders":"#EDEDED","--settings-secondary-background":"#EFEFEF","--settings-panel-nav-accent":"var(--main-accent)","--settings-panel-nav-anchor-active-background":"#E8E8E8","--settings-panel-nav-anchor-hover-background":"#F2F2F2","--settings-shortcuts-borders":"#C8C8C8","--settings-shortcuts-text":"#282828","--scrollbar-thumb-background":"#9D9D9D"},dark:{"--main-background":"#2B2A33","--header-text-primary":"#454545","--header-text-secondary":"#868686","--toolbar-button-background-primary":"#E3E3E3","--toolbar-button-text-primary":"#454545","--toolbar-button-background-primary-hover":"#BEBEBE","--toolbar-button-text-primary-hover":"#ffffff","--toolbar-button-background-important":"var(--main-accent)","--toolbar-button-text-important":"#ffffff","--toolbar-button-background-important-hover":"#33B58A","--toolbar-button-text-important-hover":"#ffffff","--selection-button-background-primary":"#ffffff","--selection-button-text-primary":"#454545","--selection-button-background-important":"var(--main-accent)","--selection-button-text-important":"#ffffff","--history-header-text":"#454545","--history-header-button-background":"#D3F1E7","--history-header-button-border":"#C3EEE0","--history-header-button-text":"var(--main-accent)","--history-header-button-background-disabled":"#F1F1F1","--history-header-button-border-disabled":"#F3F3F3","--history-header-button-text-disabled":"#EBEBEB","--history-button-background-hover":"#EFEFEF","--history-button-action-text":"var(--main-accent)","--history-button-timestamp-text":"#6D6D6D","--history-button-icon-color":"#BABABA","--history-button-active-background":"var(--main-accent)","--history-button-active-text":"#FFFFFF","--effects-header-text":"#454545","--effects-header-button-background":"#D3F1E7","--effects-header-button-border":"#C3EEE0","--effects-header-button-text":"var(--main-accent)","--filter-wrapper-background-hover":"#EFEFEF","--filter-header-text-primary":"#454545","--filter-button-reset-color":"#454545","--filter-header-info-current-background":"#D3F1E7","--filter-header-info-current-border":"#C3EEE0","--filter-header-info-current-text":"var(--main-accent)","--filter-input-track":"#E0E0E0","--filter-input-thumb":"var(--main-accent)","--filter-input-track-filled":"var(--main-accent)","--scrollbar-thumb-background":"#9D9D9D"}};const f=(()=>{class t{constructor(){this._themes=y,this._default="light",this._current={},this._styleElement=null,this.__init__()}get themes(){return this._themes}get default(){return this._default}get current(){return this._current}get styleElement(){return this._styleElement}set current(t){this._current=t}set styleElement(t){this._styleElement=t}saveThemeKeyLocally(t){localStorage.setItem("theme",t)}getSavedTheme(){const t=localStorage.getItem("theme");return t?(this.current=this.themes[t],t):(this.saveThemeKeyLocally(this.default),this.current=this.themes[this.default],this.default)}generateStyleStringFromThemeObject(t){const e=this.themes[t];let i="";return Object.keys(e).forEach((t=>i+=`${t}: ${e[t]};\n`)),i}changeTheme(t){if(!this.themes.hasOwnProperty(t))throw new Error("Theme given is not available");this.saveThemeKeyLocally(t);const e=this.generateStyleStringFromThemeObject(t);this.setStyleOnDOM(e)}setStyleOnDOM(t){this.styleElement.innerHTML=`\n        :root {\n          ${t}\n        }\n      `}__init__(){const t=this.getSavedTheme();n("head").insertAdjacentHTML("afterbegin",'\n        <style id="current-theme-variables">\n        </style>\n      '),this.styleElement=n("#current-theme-variables"),this.changeTheme(t)}}let e;return{getInstance:()=>(e||(e=new t,e=e),e)}})();const v=(()=>{class t{constructor(){this._settingsButtonElement=n(".toolbar_settings_btn"),this._themeSwitcher=f.getInstance(),this._isOpened=!1,this._shortcuts=[{title:"Escape a modal or selection",buttons:[{data:"ESC",isMouse:!1}]},{title:"Escape a modal or selection",buttons:[{data:"ESC",isMouse:!1}]}],this.__init__()}get settingsButtonElement(){return this._settingsButtonElement}get themeSwitcher(){return this._themeSwitcher}get isOpened(){return this._isOpened}set isOpened(t){this._isOpened=t}show(){this.isOpened=!0,this.changeTab("appearance"),n(".settings_wrapper").style.display="flex"}hide(){this.isOpened=!1,n(".settings_wrapper").style.display="none"}changeHeaderTitle(t){const e=t.toLowerCase();if(!["appearance","shortcuts"].find((t=>t===e)))throw new Error("Error trying to set the header title");n(".settings_header_title").innerHTML=`\n      <strong>Settings</strong> / ${h(t)}\n    `}setTabPanel(t){const e=["appearance","shortcuts"],i=t.toLowerCase();if(!e.find((t=>t===i)))throw new Error("Error trying to get tab");switch(i){case e[0]:n(".settings_shortcuts_panel").style.display="none",n(".settings_theme_panel").style.display="initial";break;case e[1]:n(".settings_shortcuts_panel").style.display="initial",n(".settings_theme_panel").style.display="none"}}setActiveAnchor(t){const e=t.toLowerCase();if(!["appearance","shortcuts"].find((t=>t===e)))throw new Error("Error trying to get tab");n(".settings_main_nav_anchor",!0).forEach((t=>{t.classList[0]===`settings_main_nav_anchor_${e}`?t.classList.add("active_anchor"):t.classList.remove("active_anchor")}))}changeTab(t){this.changeHeaderTitle(t),this.setTabPanel(t),this.setActiveAnchor(t)}setShortcut(t,e){let i="";e.forEach(((t,s)=>{const n=s!==o(e),a="mouse"===t.type.toLowerCase(),r=`\n          <div class="button_key">\n            <span class="button_key_text">${t.value.toUpperCase()}</span>\n          </div>\n        `,h=`\n            <div class="button_mouse button_mouse_${t.value.toLowerCase()}"></div>\n        `;i+=`\n          <div class="shortcut_list_item_button_slot">\n            ${a?h:r}\n          </div>\n          ${n?'\n            <div class="shortcut_list_item_button_slot">\n              <span class="button_plus">+</span>\n            </div>\n          ':""}\n        `})),n(".settings_shortcuts_list").insertAdjacentHTML("beforeend",`\n        <div class="shortcut_list_item_container">\n          <h1 class="shortcut_list_item_title">${t}</h1>\n          <div class="shortcut_list_item_buttons_wrapper">\n            ${i}\n          </div>\n        </div>     \n      `)}__init__(){n("body").insertAdjacentHTML("beforeend",`\n        <section class="settings_wrapper">\n\n          <div class="settings_container">\n\n              <header class="settings_header">\n                <span class="settings_header_title"></span>\n                <button class="settings_header_button_exit">\n                  ${m}\n                </button>\n              </header>\n\n              <main class="settings_main">\n              \n                <nav class="settings_main_nav">\n                  <a class="settings_main_nav_anchor_appearance settings_main_nav_anchor">Appearance</a>\n                  <a class="settings_main_nav_anchor_shortcuts settings_main_nav_anchor">Shortcuts</a>\n                </nav>\n\n                <section class="settings_main_panel">\n\n                  <div class="settings_theme_panel settings_main_panel_container">\n                    <header class="settings_main_panel_header">\n                      <h1 class="settings_main_panel_header_title">Theme Settings</h1>\n                      <p class="settings_main_panel_header_description">\n                        Select your prefered theme for <strong>Imagebox</strong> so you can work in the eviroment \n                        that best fits you!\n                      </p>\n                    </header>\n                    <div class="settings_themes_buttons_container">\n\n                      <button class="settings_theme_button button_light_theme">\n                        ${_}\n                        <span>Light</span>\n                      </button>\n\n                      <button class="settings_theme_button button_dark_theme">\n                        ${p}\n                        <span>Dark</span>\n                      </button>\n                    </div>\n                  </div>\n                \n                  <div class="settings_shortcuts_panel settings_main_panel_container">\n                    <header class="settings_main_panel_header">\n                      <h1 class="settings_main_panel_header_title">Shortcuts List</h1>\n                      <p class="settings_main_panel_header_description">\n                        You can boost your productivity using <strong>shortcuts</strong>! \n                      </p>\n                    </header>\n\n                    <div class="settings_shortcuts_list">\n                    </div>\n                  </div>\n\n                </section>\n              </main>\n          </div>  \n        </section>\n      `),this.changeTab("appearance"),this.hide(),n(".toolbar_settings_btn").addEventListener("click",(()=>{this.show()})),n(".settings_main_nav_anchor_appearance").addEventListener("click",(()=>{this.changeTab("appearance")})),n(".settings_main_nav_anchor_shortcuts").addEventListener("click",(()=>{this.changeTab("shortcuts")})),n(".settings_header_button_exit").addEventListener("click",(()=>{this.hide()})),n(".button_light_theme").addEventListener("click",(()=>{this.themeSwitcher.changeTheme("light")})),n(".button_dark_theme").addEventListener("click",(()=>{this.themeSwitcher.changeTheme("dark")})),this.setShortcut("Escape anything",[{type:"keyboard",value:"esc"}]),this.setShortcut("Zoom in",[{type:"keyboard",value:"ctrl"},{type:"mouse",value:"up"}]),this.setShortcut("Zoom out",[{type:"keyboard",value:"ctrl"},{type:"mouse",value:"down"}]),this.setShortcut("Speedy Zoom in",[{type:"keyboard",value:"ctrl"},{type:"keyboard",value:"shift"},{type:"mouse",value:"up"}]),this.setShortcut("Speedy Zoom out",[{type:"keyboard",value:"ctrl"},{type:"keyboard",value:"shift"},{type:"mouse",value:"down"}]),this.setShortcut("Roll-back changes",[{type:"keyboard",value:"ctrl"},{type:"keyboard",value:"z"}]),this.setShortcut("Roll-forward changes",[{type:"keyboard",value:"ctrl"},{type:"keyboard",value:"shift"},{type:"keyboard",value:"z"}]),this.setShortcut("Save image",[{type:"keyboard",value:"ctrl"},{type:"keyboard",value:"s"}]),this.setShortcut("Crop selection",[{type:"keyboard",value:"ctrl"},{type:"keyboard",value:"X"}])}}let e;return{getInstance:()=>(e||(e=new t,e=e),e)}})();const b=(()=>{class t{constructor(){this._headerSpan=n(".main_header_span"),this._headerEditing=n(".main_header_editing")}get headerSpan(){return this._headerSpan}get headerEditing(){return this._headerEditing}changeSpanText(t,e){switch(this.headerSpan.textContent=t,e){case!0:this.headerEditing.style.display="flex";break;case!1:this.headerEditing.style.display="none"}}}let e;return{getInstance:()=>(e||(e=new t,e=e),e)}})();const w=(()=>{class t{constructor(){return t.instance?t.instance:(t.instance=this,this._leftArea=n(".toolbar_leftarea"),this._rightArea=n(".toolbar_rightarea"),this.__init__(),this)}get leftArea(){return this._leftArea}get rightArea(){return this._rightArea}__init__(){this.leftArea.insertAdjacentHTML("afterbegin",`\n        <button class="toolbar_settings_btn rect_toolbar_btn">\n          ${g}\n        </button>\n\n        <button class="toolbar_instructions_btn rect_toolbar_btn">\n          ${d}\n        </button>\n      `),this.rightArea.insertAdjacentHTML("afterbegin",`\n          <button class="toolbar_clear_btn rect_toolbar_btn">\n            <span class="rect_toolbar_btn_text">Clear Canvas</span>\n          </button>\n  \n          <button class="toolbar_save_btn rect_toolbar_btn">\n            ${c}\n            <span class="rect_toolbar_btn_text">Save Image</span>\n          </button>\n  \n          <button class="toolbar_upload_btn rect_toolbar_btn">\n            <input type="file" class="toolbar_upload_input" />\n            ${u}\n            <span class="rect_toolbar_btn_text">Upload Image</span>\n          </button>\n      `)}}let e;return{getInstance:()=>(e||(e=new t,e=e),e)}})(),C=(()=>{class t{constructor(){this._data=null,this._name=null}get data(){return this._data}get name(){return this._name}set data(t){this._data=t}set name(t){this._name=t}upload(t){this.data=t,this.name=t.name}}let e;return{getInstance:()=>(e||(e=new t,e=e),e)}})();class E{constructor(t,e,i,s,n,a,r){this._id=t,this._action=e,this._canvasData=i,this._selectionData=s,this._filtersString=n,this._timestamp=a,this._isUpload=r}get id(){return this._id}get action(){return this._action}get canvasData(){return this._canvasData}get selectionData(){return this._selectionData}get filtersString(){return this._filtersString}get timestamp(){return this._timestamp}get isUpload(){return this._isUpload}}const x=(()=>{class t{constructor(){this._list=[],this._pointer=0}get list(){return this._list}get pointer(){return this._pointer}set list(t){this._list=t}set pointer(t){this._pointer=t}previous(){return 0===this.pointer||(this.pointer=this.pointer-1),this.pointer}next(){return this.pointer===this.list.length-1||(this.pointer=this.pointer+1),this.pointer}add({action:t,canvasData:e,selectionData:i,filtersString:s,isUpload:n}){const a=new E(o(this.list)+1,t,e,i,s,Date.now(),n);return this.list=[...this.list,a],a}}let e;return{getInstance:()=>(e||(e=new t,e=e),e)}})();class F{constructor(t,e,i){this._parentDomElement=t,this._callbackOnClick=e,this._historySnapshot=i,this.__init__()}get parentDomElement(){return this._parentDomElement}get callbackOnClick(){return this._callbackOnClick}get historySnapshot(){return this._historySnapshot}__init__(){const e=t(10)+"_history_button";this.parentDomElement.insertAdjacentHTML("beforeend",`\n      <button class="history_button ${e}" data-snapshot-id="${this.historySnapshot.id}">\n        <h1 class="history_button_action">${this.historySnapshot.action}</h1>\n        <h3 class="history_button_timestamp">${r(this.historySnapshot.timestamp)}</h3>\n      </button>\n    `),n(`.${e}`).addEventListener("click",(()=>{this.callbackOnClick(this.historySnapshot.id)}))}}class k{constructor(t,e,i,s,a,r){this._history=B.getInstance(),this._canvas=L.getInstance(),this._parentDomElement=n(".effects_list"),this._inputElement=null,this._currentValueElement=null,this._resetButtonElement=null,this._name=t,this._metric=e,this._min=i,this._max=s,this._def=a,this._current=a,this._filterUpdateCallback=r,this._beforeChangeValue=0,this.__init__()}get resetButtonElement(){return this._resetButtonElement}get currentValueElement(){return this._currentValueElement}get filterUpdateCallback(){return this._filterUpdateCallback}get name(){return this._name}get metric(){return this._metric}get min(){return this._min}get max(){return this._max}get def(){return this._def}get parentDomElement(){return this._parentDomElement}get inputElement(){return this._inputElement}get current(){return this._current}get beforeChangeValue(){return this._beforeChangeValue}get canvas(){return this._canvas}get history(){return this._history}get canvasFilters(){return this._canvasFilters}set current(t){this._current=t}set inputElement(t){this._inputElement=t}set currentValueElement(t){this._currentValueElement=t}set resetButtonElement(t){this._resetButtonElement=t}set beforeChangeValue(t){this._beforeChangeValue=t}updateFilterValue(t){this.current=parseFloat(t),this.beforeChangeValue=parseFloat(t),this.inputElement.value=parseFloat(t),this._updateFilterValueSpan(parseFloat(t)),this._updateInputBarWidth()}reset(){this.beforeChangeValue=this.current,this._onMouseUpFilterInput(),this._updateFilterValueSpan(this.def),this.current=this.def,this._updateInputBarWidth(),this.filterUpdateCallback(this.name,this.current,this.metric),this.inputElement.value=this.def}_updateInputBarWidth(){const t=f.getInstance();let e=(this.current-this.min)/(this.max-this.min)*100;const i=`linear-gradient(to right, ${t.current["--filter-input-track-filled"]} 0%, ${t.current["--filter-input-track-filled"]} ${e}%, ${t.current["--filter-input-track"]} ${e}%, ${t.current["--filter-input-track"]} 100%)`;this.inputElement.style.background=`${i}`}_updateFilterValueSpan(t){this.currentValueElement.textContent=t+this.metric}_handleResetFilter(t){if(this.current===this.def)return;const e=S.getInstance(),i=`${h(this.name)} reseted`;this.reset(),this.history.addSnapshot({action:i,canvasData:{image:this.canvas.ctx.getImageData(0,0,this.canvas.image.width,this.canvas.image.height),width:this.canvas.image.width,height:this.canvas.image.height},selectionData:null,filtersString:e.getFiltersString(),isUpload:!1})}_handleInputData(t){const{value:e}=t.target;this._current=e,this._updateFilterValueSpan(this.current),this._updateInputBarWidth(),this.filterUpdateCallback(this.name,this.current,this.metric)}_onMouseUpFilterInput(){if(this.current===this.beforeChangeValue)return;const t=S.getInstance(),e=`${h(this.name)} from ${this.beforeChangeValue}${this.metric} to ${this.current}${this.metric}`;this.history.addSnapshot({action:e,canvasData:{image:this.canvas.ctx.getImageData(0,0,this.canvas.image.width,this.canvas.image.height),width:this.canvas.image.width,height:this.canvas.image.height},selectionData:null,filtersString:t.getFiltersString(),isUpload:!1})}_onMouseDownFilterInput(){this.beforeChangeValue=this.current}__init__(){const e=t(10)+"_filter_input",i=t(10)+"_filter_reset_btn",s=t(10)+"_filter_current";this.parentDomElement.insertAdjacentHTML("beforeend",`\n      <div class="filter_wrapper">\n        <header class="filter_header">\n          <div class="filter_header_info">\n            <h3 class="filter_header_info_title">${h(this.name)}</h3>\n            <span class="filter_header_info_current ${s}"></span>\n          </div>\n          <button class="filter_reset_btn ${i}">${l}</button>\n        </header>\n        <input \n          class="filter_input ${e}"\n          type="range" \n          min="${this.min}" \n          max="${this.max}" \n          value="${this.current}"\n        />\n      </div>\n    `),this.inputElement=document.querySelector(`.${e}`),this.currentValueElement=document.querySelector(`.${s}`),this.resetButtonElement=document.querySelector(`.${i}`),this.inputElement.addEventListener("input",(t=>{this._handleInputData(t)})),this.resetButtonElement.addEventListener("click",(t=>{this._handleResetFilter(t)})),this._updateFilterValueSpan(this.def),this._updateInputBarWidth(),this.inputElement.addEventListener("mousedown",(()=>this._onMouseDownFilterInput())),this.inputElement.addEventListener("mouseup",(()=>this._onMouseUpFilterInput()))}}const S=(()=>{class t{constructor(){this._canvas=L.getInstance(),this._filters={},this._blur=new k("blur","px",0,100,0,((t,e,i)=>this.updateFiltersMap(t,e,i))),this._brightness=new k("brightness","%",0,200,100,((t,e,i)=>this.updateFiltersMap(t,e,i))),this._contrast=new k("contrast","%",0,200,100,((t,e,i)=>this.updateFiltersMap(t,e,i))),this._grayscale=new k("grayscale","%",0,100,0,((t,e,i)=>this.updateFiltersMap(t,e,i))),this._hueRotate=new k("hue-rotate","deg",0,360,0,((t,e,i)=>this.updateFiltersMap(t,e,i))),this._invert=new k("invert","%",0,100,0,((t,e,i)=>this.updateFiltersMap(t,e,i))),this._opacity=new k("opacity","%",0,100,100,((t,e,i)=>this.updateFiltersMap(t,e,i))),this._saturate=new k("saturate","%",0,200,100,((t,e,i)=>this.updateFiltersMap(t,e,i))),this._sepia=new k("sepia","%",0,200,0,((t,e,i)=>this.updateFiltersMap(t,e,i)))}get canvas(){return this._canvas}get filters(){return this._filters}get blur(){return this._blur}get brightness(){return this._brightness}get contrast(){return this._contrast}get grayscale(){return this._grayscale}get hueRotate(){return this._hueRotate}get invert(){return this._invert}get opacity(){return this._opacity}get saturate(){return this._saturate}get sepia(){return this._sepia}set filters(t){this._filters=t}setFilter(t,e){this._filters[t]=e}updateAllFilterButtons(){this.blur.updateFilterValue(this.filters.blur),this.brightness.updateFilterValue(this.filters.brightness),this.contrast.updateFilterValue(this.filters.contrast),this.grayscale.updateFilterValue(this.filters.grayscale),this.hueRotate.updateFilterValue(this.filters["hue-rotate"]),this.invert.updateFilterValue(this.filters.invert),this.opacity.updateFilterValue(this.filters.opacity),this.saturate.updateFilterValue(this.filters.saturate),this.sepia.updateFilterValue(this.filters.sepia)}updateFiltersMap(t,e,i){this.setFilter(t,`${e}${i}`),this.applyFiltersOnImagePreview()}applyFiltersOnCanvasContext(){this.canvas.ctx.filter=this.getFiltersString()}applyFiltersOnImagePreview(){n(".image_preview").style.filter=this.getFiltersString()}getFiltersString(){let t="";return Object.keys(this.filters).map((e=>{t+=`${e}(${this.filters[e]}) `})),t}setFiltersMapFromSnapshotString(t){const e=t.split(" ");this.filters={},e.forEach((t=>{if(!t||0===t.length)return;const[e,i]=[t.split("(")[0],t.split("(")[1].replace(")","")];this.setFilter(e,i)}))}reset(){this.blur.reset(),this.brightness.reset(),this.contrast.reset(),this.grayscale.reset(),this.hueRotate.reset(),this.invert.reset(),this.opacity.reset(),this.saturate.reset(),this.sepia.reset()}}let e;return{getInstance:()=>(e||(e=new t,e=e),e)}})();const B=(()=>{class t{constructor(){this._history=x.getInstance(),this._canvas=L.getInstance(),this._historyListElement=n(".history_list"),this._previousButtonElement=n(".history_controls_previous"),this._nextButtonElement=n(".history_controls_next"),this.previousButtonElement.addEventListener("click",(()=>{this.onClickPrevious()})),this.nextButtonElement.addEventListener("click",(()=>{this.onClickNext()})),this.renderHistoryButtonList()}get history(){return this._history}get canvas(){return this._canvas}get historyListElement(){return this._historyListElement}get previousButtonElement(){return this._previousButtonElement}get nextButtonElement(){return this._nextButtonElement}renderHistoryButtonList(){0!==this.history.list.length&&this.history.list.map((t=>{new F(this.historyListElement,(t=>{this.setCurrentSnapshot(t)}),t)}))}onClickPrevious(){if(0===this.history.pointer)return;const t=this.history.previous();this.setCurrentSnapshot(t)}onClickNext(){if(this.history.pointer===o(this.history.list))return;const t=this.history.next();this.setCurrentSnapshot(t)}updateHistoryButtonListStyle(t){null!==n(".history_button")&&(n(".history_button",!0).forEach((t=>{t.classList.remove("history_button_active"),t.classList.add("history_button_inactive")})),n(`.history_button[data-snapshot-id="${t}"]`).classList.remove("history_button_inactive"),n(`.history_button[data-snapshot-id="${t}"]`).classList.add("history_button_active"))}disablePreviousButton(){this.previousButtonElement.classList.remove("history_header_button_active"),this.previousButtonElement.classList.add("history_header_button_disabled")}disableNextButton(){this.nextButtonElement.classList.remove("history_header_button_active"),this.nextButtonElement.classList.add("history_header_button_disabled")}enablePreviousButton(){this.previousButtonElement.classList.remove("history_header_button_disabled"),this.previousButtonElement.classList.add("history_header_button_active")}enableNextButton(){this.nextButtonElement.classList.remove("history_header_button_disabled"),this.nextButtonElement.classList.add("history_header_button_active")}updateHeaderButtonsStyle(t){const e=t===o(this.history.list),i=0===t;return e||i?e&&i?(this.disablePreviousButton(),void this.disableNextButton()):e&&!i?(this.enablePreviousButton(),void this.disableNextButton()):!e&&i?(this.disablePreviousButton(),void this.enableNextButton()):void 0:(this.enablePreviousButton(),void this.enableNextButton())}setCurrentSnapshot(t){if(0===this.history.list.length)return;const e=S.getInstance();this.history.pointer=t,this.updateHeaderButtonsStyle(this.history.pointer),this.updateHistoryButtonListStyle(t);const i=this.history.list[t],s=!i.filtersString||0===i.filtersString.length;!0===i.isUpload?this.canvas.putImage(i.canvasData.image,i.canvasData.width,i.canvasData.height):this.canvas.changeImage(i.canvasData.image,i.canvasData.width,i.canvasData.height),s?e.reset():(e.setFiltersMapFromSnapshotString(i.filtersString),e.applyFiltersOnImagePreview()),e.updateAllFilterButtons()}addSnapshot({action:t,canvasData:e,selectionData:i,filtersString:s,isUpload:n}){const a=this.history.add({action:t,canvasData:e,selectionData:i,filtersString:s,isUpload:n});new F(this.historyListElement,(()=>{this.setCurrentSnapshot(a.id)}),a),this.setCurrentSnapshot(a.id)}}let e;return{getInstance:()=>(e||(e=new t,e=e),e)}})();const D=(()=>{class t{constructor(){this._startX=0,this._startY=0,this._endX=0,this._endY=0,this._offsetX=0,this._offsetY=0,this._selectionOriginCoordinates={x:0,y:0},this._isSelecting=!1,this._isOpened=!1,n(".image_preview").addEventListener("mouseover",(t=>{this.mouseOver(t)})),n(".image_preview").addEventListener("mousedown",(t=>{this.mouseDown(t)})),n(".image_preview").addEventListener("mousemove",(t=>{this.mouseMove(t)})),n(".image_preview").addEventListener("mouseup",(t=>{this.mouseUp(t)})),n(".selection_cancel_btn").addEventListener("click",(()=>this.onClickSelectionCancelBtn())),n(".selection_crop_btn").addEventListener("click",(()=>this.onClickSelectionCropBtn()))}get startX(){return this._startX}get startY(){return this._startY}get endX(){return this._endX}get endY(){return this._endY}get offsetX(){return this._offsetX}get offsetY(){return this._offsetY}get selectionOriginCoordinates(){return this._selectionOriginCoordinates}get isSelecting(){return this._isSelecting}get isOpened(){return this._isOpened}set startX(t){this._startX=t}set startY(t){this._startY=t}set endX(t){this._endX=t}set endY(t){this._endY=t}set offsetX(t){this._offsetX=t}set offsetY(t){this._offsetY=t}set selectionOriginCoordinates({x:t,y:e}){this._selectionOriginCoordinates={x:t,y:e}}set isSelecting(t){this._isSelecting=t}set isOpened(t){this._isOpened=t}resetAllSelectionCoordinates(){this.startX=0,this.startY=0,this.endX=0,this.endY=0,this.offsetX=0,this.offsetY=0,this.selectionOriginCoordinates={x:0,y:0}}getPolygonVectorPoints(t,e,i,s){const n=parseInt(t),r=parseInt(e),o=parseInt(i),h=parseInt(s),l=[a(h),a(o)],c=[a(h+n),a(o)],u=[a(h+n),a(o+r)],d=[a(h),a(o+r)];return`polygon( \n        evenodd,\n        0 0,       \n        100% 0,   \n        100% 100%,\n        0% 100%,  \n        0 0,      \n        ${l[0]} ${l[1]},\n        ${c[0]} ${c[1]},\n        ${u[0]} ${u[1]},\n        ${d[0]} ${d[1]},\n        ${l[0]} ${l[1]}\n       )`}drawRectanglePositiveXPositiveY(){const t=a(this.endX-this.startX),i=a(this.endY-this.startY),s=a(this.startY),r=a(this.startX);e(n(".selection_tool"),{width:t,height:i,top:s,left:r}),e(n(".selection_tool_mask"),{clipPath:this.getPolygonVectorPoints(t,i,a(this.offsetY-parseInt(n(".selection_tool").style.height)),a(this.offsetX-parseInt(n(".selection_tool").style.width)))}),this.selectionOriginCoordinates.x=this.offsetX-parseInt(n(".selection_tool").style.width),this.selectionOriginCoordinates.y=this.offsetY-parseInt(n(".selection_tool").style.height)}drawRectanglePositiveXNegativeY(){const t=a(this.endX-this.startX),i=a(this.startY-this.endY),s=a(this.endY),r=a(this.startX);e(n(".selection_tool"),{width:t,height:i,top:s,left:r}),e(n(".selection_tool_mask"),{clipPath:this.getPolygonVectorPoints(t,i,a(this.offsetY),a(this.offsetX-parseInt(n(".selection_tool").style.width)))}),this.selectionOriginCoordinates.x=this.offsetX-parseInt(n(".selection_tool").style.width),this.selectionOriginCoordinates.y=this.offsetY}drawRectangleNegativeXNegativeY(){const t=a(this.startX-this.endX),i=a(this.startY-this.endY),s=a(this.endY),r=a(this.endX);e(n(".selection_tool"),{width:t,height:i,top:s,left:r}),e(n(".selection_tool_mask"),{clipPath:this.getPolygonVectorPoints(t,i,a(this.offsetY),a(this.offsetX))}),this.selectionOriginCoordinates.x=this.offsetX,this.selectionOriginCoordinates.y=this.offsetY}drawRectangleNegativeXPositiveY(){const t=a(this.startX-this.endX),i=a(this.endY-this.startY),s=a(this.startY),r=a(this.endX);e(n(".selection_tool"),{width:t,height:i,top:s,left:r}),e(n(".selection_tool_mask"),{clipPath:this.getPolygonVectorPoints(t,i,a(this.offsetY-parseInt(n(".selection_tool").style.height)),a(this.offsetX))}),this.selectionOriginCoordinates.x=this.offsetX,this.selectionOriginCoordinates.y=this.offsetY-parseInt(n(".selection_tool").style.height)}mouseOver(){n(".image_preview").style.cursor="crosshair"}mouseDown(t){this.hide(),this.resetAllSelectionCoordinates();const{clientX:e,clientY:i,offsetX:s,offsetY:n}=t;this.startX=e,this.startY=i,this.selectionOriginCoordinates.x=s,this.selectionOriginCoordinates.y=n,this.isSelecting=!0,this.isOpened=!0}mouseMove(t){if(!this.isSelecting)return;this.endX=t.clientX,this.endY=t.clientY;let{offsetX:i,offsetY:s}=t;return this.offsetX=i,this.offsetY=s,n(".selection_tool").style.display="initial",e(n(".selection_tool_mask"),{display:"initial",width:a(n(".image_preview").width),height:a(n(".image_preview").height)}),this.endX<this.startX&&this.endY<this.startY?this.drawRectangleNegativeXNegativeY():this.endX>this.startX&&this.endY>this.startY?this.drawRectanglePositiveXPositiveY():this.endX>this.startX&&this.endY<this.startY?this.drawRectanglePositiveXNegativeY():this.endX<this.startX&&this.endY>this.startY?this.drawRectangleNegativeXPositiveY():void 0}mouseUp(t){this.isSelecting=!1,n(".selection_tool_controls").style.display="flex"}onClickSelectionCancelBtn(){this.hide()}onClickSelectionCropBtn(){const t=L.getInstance(),e=B.getInstance(),i=S.getInstance(),s=t.cropImage();e.addSnapshot({action:"Cropped image",canvasData:{image:s.image,width:s.width,height:s.height},selectionData:null,filtersString:i.getFiltersString(),isUpload:!1})}show(){this.isOpened=!0,i([n(".selection_tool"),n(".selection_tool_mask"),n(".selection_tool_controls")],"initial")}hide(){this.isOpened=!1,i([n(".selection_tool"),n(".selection_tool_mask"),n(".selection_tool_controls")],"none")}}let s;return{getInstance:()=>(s||(s=new t,s=s),s)}})();const L=(()=>{class t{constructor(){this._canvas=document.createElement("canvas"),this._ctx=this.canvas.getContext("2d"),this._image=C.getInstance(),this._selectionTool=null}get image(){return this._image}get canvas(){return this._canvas}get ctx(){return this._ctx}get selectionTool(){return this._selectionTool}get toast(){return this._toast}set canvas(t){this._canvas=t}set ctx(t){this._ctx=t}set selectionTool(t){this._selectionTool=t}toDataURL(){return this.canvas.toDataURL()}setSize(t,e){this.canvas.width=t,this.canvas.height=e}resetFilters(){const t=S.getInstance();0!==t.getFiltersString().length&&t.reset()}applyFiltersToCtx(){S.getInstance().applyFiltersOnCanvasContext()}applyFiltersToImagePreview(){S.getInstance().applyFiltersOnImagePreview()}putImage(t,e,i){this.ctx.clearRect(0,0,this.ctx.width,this.ctx.height),this.image.width=e,this.image.height=i,this.setSize(e,i),this.ctx.drawImage(t,0,0),n(".image_preview").src=this.toDataURL()}changeImage(t,e,i){this.ctx.clearRect(0,0,this.ctx.width,this.ctx.height),this.image.width=e,this.image.height=i,this.setSize(e,i),this.ctx.putImageData(t,0,0),n(".image_preview").src=this.toDataURL()}cropImage(){this.selectionTool=D.getInstance();const t=this.image.width,e=this.image.height,{width:i,height:s}=n(".image_preview"),[a,r]=[Number(t/i),Number(e/s)],[o,h]=[parseInt(n(".selection_tool").style.width),parseInt(n(".selection_tool").style.height)],[l,c]=[Number(o*a),Number(h*r)],[u,d]=[Number(this.selectionTool.selectionOriginCoordinates.x*a),Number(this.selectionTool.selectionOriginCoordinates.y*r)],g=this.ctx.getImageData(u,d,l,c);return this.ctx.clearRect(0,0,this.ctx.width,this.ctx.height),this.image.width=l,this.image.height=c,this.setSize(l,c),this.ctx.putImageData(g,0,0),n(".image_preview").src=this.canvas.toDataURL(),n(".toolbar_clear_btn").style.display="flex",n(".toolbar_save_btn").style.display="flex",this.selectionTool.hide(),{image:g,width:l,height:c}}}let e;return{getInstance:()=>(e||(e=new t,e=e),e)}})();new class{constructor(){this._image=null,this._canvas=null,this._selectionTool=null,this._canvasHistory=null,this._canvasFilters=null,this._themeSwitcher=f.getInstance(),this._header=b.getInstance(),this._toolbar=w.getInstance(),this._settings=v.getInstance(),this._selectionTool=D.getInstance(),this._toast=new s,this.__init__()}get canvasFilters(){return this._canvasFilters}get canvasHistory(){return this._canvasHistory}get selectionTool(){return this._selectionTool}get toolbar(){return this._toolbar}get header(){return this._header}get canvas(){return this._canvas}get image(){return this._image}get settings(){return this._settings}set canvas(t){this._canvas=t}set image(t){this._image=t}set selectionTool(t){this._selectionTool=t}set canvasHistory(t){this._canvasHistory=t}set canvasFilters(t){this._canvasFilters=t}onLoadImageFromReader(){this.canvas=L.getInstance(),this.canvasHistory=B.getInstance(),this.canvasFilters=S.getInstance(),this.canvasHistory.addSnapshot({action:"Uploaded Image",canvasData:{image:this.image,width:this.image.width,height:this.image.height},selectionData:null,filtersString:this.canvasFilters.getFiltersString(),isUpload:!0}),this.canvas.setSize(this.image.width,this.image.height),this.canvas.ctx.clearRect(0,0,this.image.width,this.image.height),this.canvas.ctx.drawImage(this.image,0,0),n(".image_preview").style.display="initial",n(".image_preview").src=this.canvas.toDataURL()}onChangeToolbarUploadInput(){const t=n(".toolbar_upload_input").files[0],e=C.getInstance();e.upload(t),this.image=e.data,this.header.changeSpanText(this.image.name,!0);let s=new FileReader;s.readAsDataURL(this.image),s.addEventListener("load",(t=>{this.image=new Image,this.image.src=t.target.result,this.image.addEventListener("load",this.onLoadImageFromReader.bind(this)),i([n(".toolbar_upload_btn")],"none"),i([n(".toolbar_save_btn"),n(".toolbar_clear_btn"),n(".effects_wrapper"),n(".history_wrapper")],"flex")}))}onClickToolbarUploadBtn(){n(".toolbar_upload_input").click()}onClickEffectsHeaderResetBtn(){this.canvas.resetFilters()}onClickToolbarSaveBtn(){const t=document.createElement("a");t.download=this.image.name+"-cropped.jpeg",this.canvas.applyFiltersToCtx(),this.canvas.ctx.drawImage(this.image,0,0),t.href=this.canvas.toDataURL(),t.click()}onClickToolbarClearBtn(){this.canvas.ctx.clearRect(0,0,this.canvas.ctx.width,this.canvas.ctx.height),this.canvas=null,n(".selection_tool").style.display="none",n(".image_preview").src="",this.header.changeSpanText("No Image uploaded",!1),n(".image_preview").style.display="none",n(".toolbar_clear_btn").style.display="none",n(".selection_crop_btn").style.display="none",n(".toolbar_save_btn").style.display="none",n(".selection_tool_mask").style.display="none",n(".effects_wrapper").style.display="none",n(".history_wrapper").style.display="none",n(".effects_list").innerHTML="",n(".toolbar_upload_btn").style.display="flex"}onWheelMove(t){const e=t.deltaY<0,i=t.deltaY>0,s=!0===t.ctrlKey,r=!0===t.shiftKey,o=n(".image_preview").clientWidth,h=r?75:20;s&&t.preventDefault(),o<10||(s&&e&&(n(".image_preview").style.width=a(o+h)),s&&i&&(n(".image_preview").style.width=a(o-h)),(s&&i||s&&e)&&this.selectionTool.hide())}escape(){return this.settings.isOpened?this.settings.hide():this.selectionTool.isOpened?this.selectionTool.hide():void 0}onKeyDown(t){if(!0!==t.ctrlKey||"61"!=t.which&&"107"!=t.which&&"173"!=t.which&&"109"!=t.which&&"187"!=t.which&&"189"!=t.which||t.preventDefault(),27===t.which)return this.escape()}setMainContainerHeight(){const t=100*(n(".main_header").clientHeight+n(".toolbar").clientHeight)/n("body").clientHeight;n("main").style.maxHeight=100-t+"vh"}__init__(){n(".toolbar_upload_btn").addEventListener("click",(()=>this.onClickToolbarUploadBtn())),n(".toolbar_upload_input").addEventListener("change",(()=>this.onChangeToolbarUploadInput())),n(".effects_header_reset_btn").addEventListener("click",(()=>this.onClickEffectsHeaderResetBtn())),n(".toolbar_save_btn").addEventListener("click",(()=>this.onClickToolbarSaveBtn())),n(".toolbar_clear_btn").addEventListener("click",(()=>this.onClickToolbarClearBtn())),window.addEventListener("wheel",(t=>this.onWheelMove(t)),{passive:!1}),window.addEventListener("mousewheel",(t=>this.onWheelMove(t)),{passive:!1}),window.addEventListener("DOMMouseScroll",(t=>this.onWheelMove(t)),{passive:!1}),window.addEventListener("resize",(()=>this.setMainContainerHeight())),document.addEventListener("keydown",(t=>this.onKeyDown(t)))}};
